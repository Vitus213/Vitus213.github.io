<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="CSAPP的lab2-bomblab, Apollo-213">
    <meta name="description" content="
这个lab2真的做了很久,做的久,解析写的也久,还抽了部分打题的时间写的,这个lab是真的有意思

前置知识:
gdb使用指北
汇编语言的基本语法
链表
递归函数
耐得住诱惑

phase_10x0000000000400ee0 &amp;lt;">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>CSAPP的lab2-bomblab | Apollo-213</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.3.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Apollo-213</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Apollo-213</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/6.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">CSAPP的lab2-bomblab</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                                <span class="chip bg-color">学习笔记</span>
                            </a>
                        
                            <a href="/tags/CSAPP/">
                                <span class="chip bg-color">CSAPP</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/CS/" class="post-category">
                                CS
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2024-01-21
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2024-01-21
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    7.2k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    36 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <blockquote>
<p>这个lab2真的做了很久,做的久,解析写的也久,还抽了部分打题的时间写的,这个lab是真的有意思</p>
</blockquote>
<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识:"></a>前置知识:</h2><ul>
<li><a target="_blank" rel="noopener" href="https://zhzvite.github.io/EATPOOP/gdb_use/2024/01/17/">gdb使用指北</a></li>
<li>汇编语言的基本语法</li>
<li>链表</li>
<li>递归函数</li>
<li>耐得住诱惑</li>
</ul>
<h2 id="phase-1"><a href="#phase-1" class="headerlink" title="phase_1"></a>phase_1</h2><pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">0x0000000000400ee0 &lt;+0&gt;:     sub    $0x8,%rsp
0x0000000000400ee4 &lt;+4&gt;:     mov    $0x402400,%esi
0x0000000000400ee9 &lt;+9&gt;:     callq  0x401338 &lt;strings_not_equal&gt;
0x0000000000400eee &lt;+14&gt;:    test   %eax,%eax
0x0000000000400ef0 &lt;+16&gt;:    je     0x400ef7 &lt;phase_1+23&gt;
0x0000000000400ef2 &lt;+18&gt;:    callq  0x40143a &lt;explode_bomb&gt;
0x0000000000400ef7 &lt;+23&gt;:    add    $0x8,%rsp
0x0000000000400efb &lt;+27&gt;:    retq<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>phase_1算是热身的一关，主要就是要发现到<strong>0x402400</strong>这个特殊的内存地址，毕竟默认下第一个参数是%rdi，那么第二个参数就是%rsi,有充分的理由怀疑，是在<strings_not_equal>这个函数里面对%rdi和%rsi里面的内存的函数值进行了比较,然后去这个函数里面看一看,可以猜出来时相等的话返回值是0,(test %eax,%eax),所以直接连string函数都不用看了,直接把0x402400里面的值找出来就是答案</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">p(char*)0x402400<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>当热身了.</p>
<string_not_equal>

<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">40135c:	0f b6 03             	movzbl (%rbx),%eax    ; 将 %rbx 指向的字节加载到 %eax 中，并进行零扩展为32位
40135f:	84 c0                	test   %al,%al       ; 测试 %al 中的值是否为零
401361:	74 25                	je     401388 &lt;strings_not_equal+0x50&gt;  ; 如果为零（字符串结束），跳转到 401388

401363:	3a 45 00             	cmp    0x0(%rbp),%al   ; 比较地址为 (%rbp) 的字节与 %al 中的值
401366:	74 0a                	je     401372 &lt;strings_not_equal+0x3a&gt;  ; 如果相等，跳转到 401372

401368:	eb 25                	jmp    40138f &lt;strings_not_equal+0x57&gt;  ; 比较不匹配，跳转到 40138f

40136a:	3a 45 00             	cmp    0x0(%rbp),%al   ; 比较地址为 (%rbp) 的字节与 %al 中的值
40136d:	0f 1f 00             	nopl   (%rax)         ; No operation，占位符，可忽略
401370:	75 24                	jne    401396 &lt;strings_not_equal+0x5e&gt;  ; 如果不相等，跳转到 401396

401372:	48 83 c3 01          	add    $0x1,%rbx       ; 将 %rbx 增加 1（移动到第一个字符串的下一个字符）
401376:	48 83 c5 01          	add    $0x1,%rbp       ; 将 %rbp 增加 1（移动到第二个字符串的下一个字符）

40137a:	0f b6 03             	movzbl (%rbx),%eax    ; 将 %rbx 指向的字节加载到 %eax 中，并进行零扩展为32位
40137d:	84 c0                	test   %al,%al       ; 测试 %al 中的值是否为零
40137f:	75 e9                	jne    40136a &lt;strings_not_equal+0x32&gt;  ; 如果不为零，继续比较

401381:	ba 00 00 00 00       	mov    $0x0,%edx      ; 将 0 移动到 %edx（表示字符串相等）
401386:	eb 13                	jmp    40139b &lt;strings_not_equal+0x63&gt;  ; 跳转到 40139b（函数结束）

401388:	ba 00 00 00 00       	mov    $0x0,%edx      ; 将 0 移动到 %edx（表示字符串相等）
40138d:	eb 0c                	jmp    40139b &lt;strings_not_equal+0x63&gt;  ; 跳转到 40139b（函数结束）

40138f:	ba 01 00 00 00       	mov    $0x1,%edx      ; 将 1 移动到 %edx（表示字符串不相等）
401394:	eb 05                	jmp    40139b &lt;strings_not_equal+0x63&gt;  ; 跳转到 40139b（函数结束）

401396:	ba 01 00 00 00       	mov    $0x1,%edx      ; 将 1 移动到 %edx（表示字符串不相等）
40139b:	89 d0                	mov    %edx,%eax      ; 将 %edx 的值移动到 %eax（结果）
40139d:	5b                   	pop    %rbx           ; 从堆栈中弹出 %rbx
40139e:	5d                   	pop    %rbp           ; 从堆栈中弹出 %rbp
40139f:	41 5c                	pop    %r12           ; 从堆栈中弹出 %r12
4013a1:	c3                   	retq                  ; 从函数中返回
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="phase-2"><a href="#phase-2" class="headerlink" title="phase_2"></a>phase_2</h2><pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">0x0000000000400efc &lt;+0&gt;:     push   %rbp             ; 将 %rbp 寄存器的值推送到栈上
0x0000000000400efd &lt;+1&gt;:     push   %rbx             ; 将 %rbx 寄存器的值推送到栈上
0x0000000000400efe &lt;+2&gt;:     sub    $0x28,%rsp       ; 在栈上分配 0x28（40）字节的空间
0x0000000000400f02 &lt;+6&gt;:     mov    %rsp,%rsi         ; 将栈顶地址（%rsp）的值传递给 %rsi 寄存器
0x0000000000400f05 &lt;+9&gt;:     callq  0x40145c &lt;read_six_numbers&gt;  ; 调用 read_six_numbers 函数
0x0000000000400f0a &lt;+14&gt;:    cmpl   $0x1,(%rsp)      ; 比较栈上第一个元素的值与 1 是否相等
0x0000000000400f0e &lt;+18&gt;:    je     0x400f30 &lt;phase_2+52&gt;  ; 如果相等，跳转到 0x400f30 处
0x0000000000400f10 &lt;+20&gt;:    callq  0x40143a &lt;explode_bomb&gt;  ; 否则调用 explode_bomb 函数
0x0000000000400f15 &lt;+25&gt;:    jmp    0x400f30 &lt;phase_2+52&gt;  ; 跳转到 0x400f30 处

0x0000000000400f17 &lt;+27&gt;:    mov    -0x4(%rbx),%eax   ; 将 %rbx 寄存器指向的地址减 4的值 加载到 %eax,第二个参数,发现是加一倍
0x0000000000400f1a &lt;+30&gt;:    add    %eax,%eax         ; 将 %eax 寄存器的值加倍
0x0000000000400f1c &lt;+32&gt;:    cmp    %eax,(%rbx)      ; 比较 %eax 和 %rbx 寄存器指向的地址处的值
0x0000000000400f1e &lt;+34&gt;:    je     0x400f25 &lt;phase_2+41&gt;  ; 如果相等，跳转到 0x400f25 处
0x0000000000400f20 &lt;+36&gt;:    callq  0x40143a &lt;explode_bomb&gt;  ; 否则调用 explode_bomb 函数
0x0000000000400f25 &lt;+41&gt;:    add    $0x4,%rbx        ; 将 %rbx 寄存器的值增加 4
0x0000000000400f29 &lt;+45&gt;:    cmp    %rbp,%rbx        ; 比较 %rbp 和 %rbx 寄存器的值,比较是否是第六个数
0x0000000000400f2c &lt;+48&gt;:    jne    0x400f17 &lt;phase_2+27&gt;  ; 如果不相等，跳转到 0x400f17 处
0x0000000000400f2e &lt;+50&gt;:    jmp    0x400f3c &lt;phase_2+64&gt;  ; 否则跳转到 0x400f3c 处,

0x0000000000400f30 &lt;+52&gt;:    lea    0x4(%rsp),%rbx  ; 计算栈上地址 %rsp + 4，并将结果存储到 %rbx 寄存器
0x0000000000400f35 &lt;+57&gt;:    lea    0x18(%rsp),%rbp ; 计算栈上地址 %rsp + 0x18（24），并将结果存储到 %rbp 寄存器
0x0000000000400f3a &lt;+62&gt;:    jmp    0x400f17 &lt;phase_2+27&gt;  ; 跳转到 0x400f17 处
0x0000000000400f3c &lt;+64&gt;:    add    $0x28,%rsp       ; 在栈上释放 0x28（40）字节的空间
0x0000000000400f40 &lt;+68&gt;:    pop    %rbx             ; 弹出栈顶的 %rbx 寄存器的值
0x0000000000400f41 &lt;+69&gt;:    pop    %rbp             ; 弹出栈顶的 %rbp 寄存器的值
0x0000000000400f42 &lt;+70&gt;:    retq                    ; 从函数中返回
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这是一个简单的倍增循环,需要知道stack的概念.</p>
<p>一开始能够简单的确定stack上的第一个元素与1是相等的</p>
<p>然后把第二个元素的地址加载到rbx上,因为里面存的是int,int是4个bit,所以每次加四,然后把前一个值加倍看他是否与当前值相等.</p>
<p>故六次循环后我们会发现每次循环能不断推断出第一个,第二个,直到第六个元素,为倍增关系</p>
<p>故答案: 1 2 4 8 16 32</p>
<p>代码混淆解释</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">rbx&#x3D;rsp+4  &#x2F;&#x2F;lea 0x4(%rsp),%rbx
rbx&#x3D;*(rsp+4) &#x2F;&#x2F;mov 0x4(%rsp),%rbx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="phase-3"><a href="#phase-3" class="headerlink" title="phase_3"></a>phase_3</h2><p>人工打了跳转标记</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">0000000000400f43 &lt;phase_3&gt;:
  400f43:	48 83 ec 18          	sub    $0x18,%rsp
  400f47:	48 8d 4c 24 0c       	lea    0xc(%rsp),%rcx
  400f4c:	48 8d 54 24 08       	lea    0x8(%rsp),%rdx
  400f51:	be cf 25 40 00       	mov    $0x4025cf,%esi
  400f56:	b8 00 00 00 00       	mov    $0x0,%eax
  400f5b:	e8 90 fc ff ff       	callq  400bf0 &lt;__isoc99_sscanf@plt&gt;
  400f60:	83 f8 01             	cmp    $0x1,%eax
  400f63:	7f 05                	jg     .L1
  400f65:	e8 d0 04 00 00       	callq  40143a &lt;explode_bomb&gt;
  .L1
  400f6a:	83 7c 24 08 07       	cmpl   $0x7,0x8(%rsp)
  400f6f:	77 3c                	ja     .L2
  400f71:	8b 44 24 08          	mov    0x8(%rsp),%eax
  400f75:	ff 24 c5 70 24 40 00 	jmpq   *0x402470(,%rax,8)
  400f7c:	b8 cf 00 00 00       	mov    $0xcf,%eax
  400f81:	eb 3b                	jmp    .L3
  400f83:	b8 c3 02 00 00       	mov    $0x2c3,%eax
  400f88:	eb 34                	jmp    .L3
  400f8a:	b8 00 01 00 00       	mov    $0x100,%eax
  400f8f:	eb 2d                	jmp    .L3
  400f91:	b8 85 01 00 00       	mov    $0x185,%eax
  400f96:	eb 26                	jmp    .L3
  400f98:	b8 ce 00 00 00       	mov    $0xce,%eax
  400f9d:	eb 1f                	jmp    .L3
  400f9f:	b8 aa 02 00 00       	mov    $0x2aa,%eax
  400fa4:	eb 18                	jmp    .L3
  400fa6:	b8 47 01 00 00       	mov    $0x147,%eax
  400fab:	eb 11                	jmp    .L3
  .L2 
  400fad:	e8 88 04 00 00       	callq  40143a &lt;explode_bomb&gt;
  400fb2:	b8 00 00 00 00       	mov    $0x0,%eax
  400fb7:	eb 05                	jmp    .L3
  400fb9:	b8 37 01 00 00       	mov    $0x137,%eax
  .L3
  400fbe:	3b 44 24 0c          	cmp    0xc(%rsp),%eax
  400fc2:	74 05                	je    .L4
  400fc4:	e8 71 04 00 00       	callq  40143a &lt;explode_bomb&gt;
  .L4
  400fc9:	48 83 c4 18          	add    $0x18,%rsp
  400fcd:	c3                   	retq   
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>gpt解读</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">0000000000400f43 &lt;phase_3&gt;:
  400f43:	48 83 ec 18          	sub    $0x18,%rsp          ; 为局部变量分配空间
  400f47:	48 8d 4c 24 0c       	lea    0xc(%rsp),%rcx     ; 将局部变量地址加载到寄存器 rcx 中
  400f4c:	48 8d 54 24 08       	lea    0x8(%rsp),%rdx     ; 将局部变量地址加载到寄存器 rdx 中
  400f51:	be cf 25 40 00       	mov    $0x4025cf,%esi      ; 将常量地址加载到寄存器 esi 中
  400f56:	b8 00 00 00 00       	mov    $0x0,%eax          ; 清零寄存器 eax
  400f5b:	e8 90 fc ff ff       	callq  400bf0 &lt;__isoc99_sscanf@plt&gt;  ; 调用 sscanf 函数，将输入解析为整数,
  400f60:	83 f8 01             	cmp    $0x1,%eax          ; 比较返回值与1
  400f63:	7f 05                	jg     .L1                ; 如果大于1，跳转到.L1
  400f65:	e8 d0 04 00 00       	callq  40143a &lt;explode_bomb&gt;  ; 否则，调用 explode_bomb 函数
  .L1
  400f6a:	83 7c 24 08 07       	cmpl   $0x7,0x8(%rsp)    ; 比较第二个局部变量和7,0x8(%rsp)要小于7(无符号类型)
  400f6f:	77 3c                	ja     .L2                ; 如果大于7，跳转到.L2
  400f71:	8b 44 24 08          	mov    0x8(%rsp),%eax    ; 将第二个局部变量加载到寄存器 eax 中
  400f75:	ff 24 c5 70 24 40 00 	jmpq   *0x402470(,%rax,8)  ; 通过跳转表间接调用不同的分支(%rax*8+*402470)
  400f7c:	b8 cf 00 00 00       	mov    $0xcf,%eax        ; 第一种分支1:
  400f81:	eb 3b                	jmp    .L3                ; 跳转到.L3
  400f83:	b8 c3 02 00 00       	mov    $0x2c3,%eax       ; 第二种分支:2
  400f88:	eb 34                	jmp    .L3                ; 跳转到.L3
  400f8a:	b8 00 01 00 00       	mov    $0x100,%eax       ; 第三种分支.输入为3
  400f8f:	eb 2d                	jmp    .L3                ; 跳转到.L3
  400f91:	b8 85 01 00 00       	mov    $0x185,%eax       ; 第四种分支:4
  400f96:	eb 26                	jmp    .L3                ; 跳转到.L3
  400f98:	b8 ce 00 00 00       	mov    $0xce,%eax        ; 第五种分支
  400f9d:	eb 1f                	jmp    .L3                ; 跳转到.L3
  400f9f:	b8 aa 02 00 00       	mov    $0x2aa,%eax       ; 第六种分支
  400fa4:	eb 18                	jmp    .L3                ; 跳转到.L3
  400fa6:	b8 47 01 00 00       	mov    $0x147,%eax       ; 第七种分支
  400fab:	eb 11                	jmp    .L3                ; 跳转到.L3
  .L2 
  400fad:	e8 88 04 00 00       	callq  40143a &lt;explode_bomb&gt;  ; 如果第二个局部变量大于7，调用 explode_bomb 函数
  400fb2:	b8 00 00 00 00       	mov    $0x0,%eax          ; 将返回值清零
  400fb7:	eb 05                	jmp    .L3                ; 跳转到.L3
  400fb9:	b8 37 01 00 00       	mov    $0x137,%eax       ; 第八种分支
  .L3
  400fbe:	3b 44 24 0c          	cmp    0xc(%rsp),%eax    ; 比较第三个局部变量和返回值 
  400fc2:	74 05                	je    .L4                ; 如果相等，跳转到.L4
  400fc4:	e8 71 04 00 00       	callq  40143a &lt;explode_bomb&gt;  ; 否则，调用 explode_bomb 函数
  .L4
  400fc9:	48 83 c4 18          	add    $0x18,%rsp         ; 函数结束，恢复栈空间
  400fcd:	c3                   	retq                      ; 返回
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>_isoc99_sscanf</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">其转换了含有几个整数的字符串则返回值是几<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<ul>
<li><code>0x0(%rsp)</code> 是栈顶位置，通常是函数的返回地址。</li>
<li><code>0x4(%rsp)</code> 是栈顶位置向下偏移4字节的位置，可能是一个局部变量或参数。</li>
</ul>
<p>在这么多条分支里面找到一条能成立的就可以了</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">jmpq   *0x402470(,%rax,8) <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这个函数是重点,这是跳转表间接实现switch操作,先确定输入的第一个变量在[0,7]之间,首先用gdb指令确定*0x402470的值,假定其会跳转到第一个分支,即令第一个变量等于0,刚好能跳转到第一个分支,那想要炸弹不爆炸只能%eax&#x3D;207,所以其中一种答案就算出来了</p>
<p>答案 0 207</p>
<h2 id="phase-4"><a href="#phase-4" class="headerlink" title="phase_4"></a>phase_4</h2><pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">  ;设第一个数字为a,第二个数字为b
  0x000000000040100c &lt;+0&gt;:     sub    $0x18,%rsp
  0x0000000000401010 &lt;+4&gt;:     lea    0xc(%rsp),%rcx
  0x0000000000401015 &lt;+9&gt;:     lea    0x8(%rsp),%rdx
  0x000000000040101a &lt;+14&gt;:    mov    $0x4025cf,%esi
  0x000000000040101f &lt;+19&gt;:    mov    $0x0,%eax
  0x0000000000401024 &lt;+24&gt;:    callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;;读入
  0x0000000000401029 &lt;+29&gt;:    cmp    $0x2,%eax;个数为2
  0x000000000040102c &lt;+32&gt;:    jne    0x401035 &lt;phase_4+41&gt;
  0x000000000040102e &lt;+34&gt;:    cmpl   $0xe,0x8(%rsp);比较a和0xe,a&lt;&#x3D;0xe&#x3D;14
  0x0000000000401033 &lt;+39&gt;:    jbe    .L1
  0x0000000000401035 &lt;+41&gt;:    callq  0x40143a &lt;explode_bomb&gt;
.L1
 0x000000000040103a &lt;+46&gt;:    mov    $0xe,%edx;往里面塞两个值edx,esi更新;
  0x000000000040103f &lt;+51&gt;:    mov    $0x0,%esi
  0x0000000000401044 &lt;+56&gt;:    mov    0x8(%rsp),%edi;edi&#x3D;a
  0x0000000000401048 &lt;+60&gt;:    callq  0x400fce &lt;func4&gt;;调用func4
  0x000000000040104d &lt;+65&gt;:    test   %eax,%eax;还要看eax是否为0,即返回值是否为0,结合后文,返回值要0
  0x000000000040104f &lt;+67&gt;:    jne    .L2
  0x0000000000401051 &lt;+69&gt;:    cmpl   $0x0,0xc(%rsp);故b&#x3D;0
  0x0000000000401056 &lt;+74&gt;:    je     0x40105d &lt;phase_4+81&gt;
  .L2
  0x0000000000401058 &lt;+76&gt;:    callq  0x40143a &lt;explode_bomb&gt;
  0x000000000040105d &lt;+81&gt;:    add    $0x18,%rsp
  0x0000000000401061 &lt;+85&gt;:    retq<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>现在我们要确定数字a,b,已知b&#x3D;0,故要确定a的值</p>
<p>补充资料</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">rdi：第一个参数
rsi：第二个参数
rdx：第三个参数
rcx：第四个参数
r8：第五个参数
r9：第六个参数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><func4>#目标是让rax即返回值是0</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">;rdi&#x3D;a;edx&#x3D;e;esi&#x3D;0
  .L3
  0x0000000000400fce &lt;+0&gt;:     sub    $0x8,%rsp
  # retval&#x3D;rdx
   0x0000000000400fd2 &lt;+4&gt;:     mov    %edx,%eax  
   #retval-&#x3D;rsi
   0x0000000000400fd4 &lt;+6&gt;:     sub    %esi,%eax
   0x0000000000400fd6 &lt;+8&gt;:     mov    %eax,%ecx
   0x0000000000400fd8 &lt;+10&gt;:    shr    $0x1f,%ecx#右移31位&#x3D;&#x3D;&gt;取符号位
   0x0000000000400fdb &lt;+13&gt;:    add    %ecx,%eax

   ---
   0x0000000000400fdd &lt;+15&gt;:    sar    %eax ;eax&#x2F;&#x3D;2;ret&#x3D;ret&gt;&gt;1
   0x0000000000400fdf &lt;+17&gt;:    lea    (%rax,%rsi,1),%ecx;ecx&#x3D;rax+rsi
   
   0x0000000000400fe2 &lt;+20&gt;:    cmp    %edi,%ecx;&lt;&#x3D;
   #if(ecx&#x3D;&#x3D;edi)return 0
   #if(ecx&lt;edi)func()
   0x0000000000400fe4 &lt;+22&gt;:    jle    .L1
   0x0000000000400fe6 &lt;+24&gt;:    lea    -0x1(%rcx),%edx
   0x0000000000400fe9 &lt;+27&gt;:    callq  0x400fce &lt;func4&gt;
   
   0x0000000000400fee &lt;+32&gt;:    add    %eax,%eax#倍增
   0x0000000000400ff0 &lt;+34&gt;:    jmp    .L2
  .L1
  0x0000000000400ff2 &lt;+36&gt;:    mov    $0x0,%eax;
  
   0x0000000000400ff7 &lt;+41&gt;:    cmp    %edi,%ecx
   0x0000000000400ff9 &lt;+43&gt;:    jge    .L2
   #esi&#x3D;rcx+1
   0x0000000000400ffb &lt;+45&gt;:    lea    0x1(%rcx),%esi
   0x0000000000400ffe &lt;+48&gt;:    .L3;调回到开头,即为一次递归调用,观察其改变什么值就可以了
   ;即返回值ret后要再倍增+1
   0x0000000000401003 &lt;+53&gt;:    lea    0x1(%rax,%rax,1),%eax;2*%rax+1
   .L2
   0x0000000000401007 &lt;+57&gt;:    add    $0x8,%rsp
   0x000000000040100b &lt;+61&gt;:    retq<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>观察如何让rax&#x3D;0;</p>
<p>把它按行翻译为c++代码,然后跑一遍就好了</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//int rdi=x,edx=a1,esi=a2,rcx=tmp</span>
<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span><span class="token keyword">int</span> a2<span class="token punctuation">,</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token comment">//ret=a1</span>
<span class="token comment">//ret-=a2</span>
<span class="token comment">//int tmp=ret</span>
<span class="token comment">//tmp>>31</span>
tmp<span class="token operator">=</span><span class="token punctuation">(</span>a1<span class="token operator">-</span>a2<span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">31</span><span class="token punctuation">;</span>
ret<span class="token operator">=</span><span class="token punctuation">(</span>a1<span class="token operator">-</span>a2<span class="token operator">+</span>tmp<span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span>
tmp<span class="token operator">=</span>ret<span class="token operator">+</span>a2
<span class="token keyword">if</span><span class="token punctuation">(</span>tmp<span class="token operator">==</span>x<span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>tmp<span class="token operator">&lt;</span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
ret<span class="token operator">=</span><span class="token function">func</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span>tmp<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>x<span class="token punctuation">)</span>
<span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span>ret<span class="token operator">+</span><span class="token number">1</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>tmp<span class="token operator">></span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 ret<span class="token operator">=</span><span class="token function">func</span><span class="token punctuation">(</span>a1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>a2<span class="token punctuation">,</span>x<span class="token punctuation">)</span>
 <span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span>ret<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>测试代码</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token comment">//int rdi=x,edx=a1,esi=a2,rcx=tmp</span>
<span class="token comment">//rdi=x;edx=e;esi=0</span>
<span class="token keyword">int</span>  <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span><span class="token keyword">int</span> a2<span class="token punctuation">,</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token comment">//ret=a1</span>
<span class="token comment">//ret-=a2</span>
<span class="token comment">//int tmp=ret</span>
<span class="token comment">//tmp>>31</span>
<span class="token keyword">int</span> tmp<span class="token operator">=</span><span class="token punctuation">(</span>a1<span class="token operator">-</span>a2<span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">31</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> ret<span class="token operator">=</span><span class="token punctuation">(</span>a1<span class="token operator">-</span>a2<span class="token operator">+</span>tmp<span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
tmp<span class="token operator">=</span>ret<span class="token operator">+</span>a2<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>tmp<span class="token operator">==</span>x<span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>tmp<span class="token operator">&lt;</span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
ret<span class="token operator">=</span><span class="token function">func</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span>tmp<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span>ret<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>tmp<span class="token operator">></span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 ret<span class="token operator">=</span><span class="token function">func</span><span class="token punctuation">(</span>a1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>a2<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span>ret<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        cout<span class="token operator">&lt;&lt;</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后我们就能够很清楚的知道四个数字:0 1 3 7</p>
<p>所以答案有四种: </p>
<ul>
<li>0 0</li>
<li>1 0</li>
<li>3 0:</li>
<li>7 0</li>
</ul>
<h2 id="phase-5"><a href="#phase-5" class="headerlink" title="phase_5"></a>phase_5</h2><pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">0000000000401062 &lt;phase_5&gt;:  !# %fs:0x28 -&gt; 3678849592732380416 这是一个保护堆栈的值
  401062:   53                      push   %rbx
  401063:   48 83 ec 20             sub    $0x20,%rsp   !# 开了32字节
  401067:   48 89 fb                mov    %rdi,%rbx    !# rbx 也是string 
  40106a:   64 48 8b 04 25 28 00    mov    %fs:0x28,%rax
  401071:   00 00 
  401073:   48 89 44 24 18          mov    %rax,0x18(%rsp) !# fs:0x28
  401078:   31 c0                   xor    %eax,%eax
  40107a:   e8 9c 02 00 00          callq  40131b &lt;string_length&gt; ;返回值是rax
  40107f:   83 f8 06                cmp    $0x6,%eax       !# string_length 为6就去 4010d2 执行，否则爆炸
  401082:   74 4e                   je     4010d2 &lt;phase_5+0x70&gt;
  401084:   e8 b1 03 00 00          callq  40143a &lt;explode_bomb&gt;
  401089:   eb 47                   jmp    4010d2 &lt;phase_5+0x70&gt;
                                            !# 最初rax&#x3D;0, 循环6次， 每次处理第 rax个字符
  40108b:   0f b6 0c 03             movzbl (%rbx,%rax,1),%ecx  !# ecx &#x3D; *rbx + *rax &#x3D; *rdi + *rax 即第rax个字符
  40108f:   88 0c 24                mov    %cl,(%rsp)          !# 栈顶 &#x3D; cl                     即第rax个字符
  401092:   48 8b 14 24             mov    (%rsp),%rdx         !# rdx &#x3D; rsp &#x3D; cl                即第rax个字符
  401096:   83 e2 0f                and    $0xf,%edx           !# edx &amp;&#x3D; 0xf, edx &#x3D; cl 的低4位  即第rax个字符的低四位
  401099:   0f b6 92 b0 24 40 00    movzbl 0x4024b0(%rdx),%edx !# 0x4024b0[*rdx] -&gt; edx
  4010a0:   88 54 04 10             mov    %dl,0x10(%rsp,%rax,1) !dl -&gt; 0x10 + *rsp + *rax
  4010a4:   48 83 c0 01             add    $0x1,%rax             !# *rax ++
  4010a8:   48 83 f8 06             cmp    $0x6,%rax             !# rax !&#x3D; 0x6  即循环六次
  4010ac:   75 dd                   jne    40108b &lt;phase_5+0x29&gt;

  4010ae:   c6 44 24 16 00          movb   $0x0,0x16(%rsp)
  4010b3:   be 5e 24 40 00          mov    $0x40245e,%esi      !# &quot;flyers&quot;
  4010b8:   48 8d 7c 24 10          lea    0x10(%rsp),%rdi     !# 0x10(%rsp) ~ 0x15(%rsp)  和 &quot;flyers&quot;相等就跳转即成功了 否则爆炸
  4010bd:   e8 76 02 00 00          callq  401338 &lt;strings_not_equal&gt;
  4010c2:   85 c0                   test   %eax,%eax
  4010c4:   74 13                   je     4010d9 &lt;phase_5+0x77&gt;
  4010c6:   e8 6f 03 00 00          callq  40143a &lt;explode_bomb&gt;
  4010cb:   0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)
  4010d0:   eb 07                   jmp    4010d9 &lt;phase_5+0x77&gt;
  
  4010d2:   b8 00 00 00 00          mov    $0x0,%eax
  4010d7:   eb b2                   jmp    40108b &lt;phase_5+0x29&gt;;跳回40108b

  4010d9:   48 8b 44 24 18          mov    0x18(%rsp),%rax
  4010de:   64 48 33 04 25 28 00    xor    %fs:0x28,%rax  !# 如果相等就跳转则说明没有溢出
  4010e5:   00 00 
  4010e7:   74 05                   je     4010ee &lt;phase_5+0x8c&gt;
  4010e9:   e8 42 fa ff ff          callq  400b30 &lt;__stack_chk_fail@plt&gt;
  4010ee:   48 83 c4 20             add    $0x20,%rsp
  4010f2:   5b                      pop    %rbx
  4010f3:   c3                      retq<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>啥逼玩意能通过偏移量达到flyers,取末尾四位,在来一遍这个地址</p>
<p>把这两个地址的所含字符串输出出来</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">mov    $0x40245e,%esi 
 movzbl 0x4024b0(%rdx),%edx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>能找到这两个字符串</p>
<p>问题串:adui<strong>ers</strong>n<strong>f</strong>otvby<strong>l</strong>So you think you can stop the bomb with ctrl-c, do you?</p>
<p>转换后的串:flyers</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">40108b:   0f b6 0c 03             movzbl (%rbx,%rax,1),%ecx  !# ecx &#x3D; *rbx + *rax &#x3D; *rdi + *rax 即第rax个字符
  40108f:   88 0c 24                mov    %cl,(%rsp)          !# 栈顶 &#x3D; cl                     即第rax个字符
  401092:   48 8b 14 24             mov    (%rsp),%rdx         !# rdx &#x3D; rsp &#x3D; cl                即第rax个字符
  401096:   83 e2 0f                and    $0xf,%edx           !# edx &amp;&#x3D; 0xf, edx &#x3D; cl 的低4位  即第rax个字符的低四位<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>即每次取输入字符串的一个字符,取其低四位,以此为索引,在问题串中找对应偏移量的字符,存入stack中,循环六次后,和转换后的串一比较,相等即通过</p>
<p>偏移公式:</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">movzbl 0x4024b0(%rdx),%edx;0x4024b0是问题串的首位置
 mov    %dl,0x10(%rsp,%rax,1);把它存起来,rax会递增,所以每个字符会一个一个存起来<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>然后对着ascII码表算一算</p>
<ol>
<li>9&gt;&gt;Y</li>
<li>15&gt;&gt;o</li>
<li>14&gt;&gt;n</li>
<li>5&gt;&gt;e</li>
<li>6&gt;&gt;f</li>
<li>7&gt;&gt;g</li>
</ol>
<p>答案Yonefg(其中一种)</p>
<h2 id="phase-6"><a href="#phase-6" class="headerlink" title="phase_6"></a>phase_6</h2><p>设数串为a,b,c,d,e,f</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">  0x00000000004010fc &lt;+8&gt;:     sub    $0x50,%rsp
  0x0000000000401100 &lt;+12&gt;:    mov    %rsp,%r13
  0x0000000000401103 &lt;+15&gt;:    mov    %rsp,%rsi
  0x0000000000401106 &lt;+18&gt;:    callq  0x40145c &lt;read_six_numbers&gt;
  0x000000000040110b &lt;+23&gt;:    mov    %rsp,%r14
  0x000000000040110e &lt;+26&gt;:    mov    $0x0,%r12d
  ;模块:即这六个数字,每个数只出现一遍且都出现
  0x0000000000401114 &lt;+32&gt;:    mov    %r13,%rbp;r13的地址对应的值是第一个数字
  0x0000000000401117 &lt;+35&gt;:    mov    0x0(%r13),%eax
  0x000000000040111b &lt;+39&gt;:    sub    $0x1,%eax
  0x000000000040111e &lt;+42&gt;:    cmp    $0x5,%eax;eax&gt;&#x3D;0x5,故a&lt;&#x3D;5
  0x0000000000401121 &lt;+45&gt;:    jbe    .L1;&lt;&#x3D;就不炸
  .L1;上面的一些代码保证了每一个数字都是在[1,6]之间的
  0x0000000000401128 &lt;+52&gt;:    add    $0x1,%r12d;r12d++
  0x000000000040112c &lt;+56&gt;:    cmp    $0x6,%r12d;跑六次循环
  0x0000000000401130 &lt;+60&gt;:    je     .L2
  0x0000000000401132 &lt;+62&gt;:    mov    %r12d,%ebx;ebx&#x3D;r12d
  0x0000000000401135 &lt;+65&gt;:    movslq %ebx,%rax
  0x0000000000401138 &lt;+68&gt;:    mov    (%rsp,%rax,4),%eax,;rax作为变量,会依次取出每一个元素,应为rsp对着的就是6,那么+1*4就是5(测试样例为6,5,4,3,2,1),每次的循环内层循环的辞书是下降的
  0x000000000040113b &lt;+71&gt;:    cmp    %eax,0x0(%rbp)  ;0x0(%rbp)!&#x3D;%eax,保证六个数字每个只出现一次
  0x000000000040113e &lt;+74&gt;:    jne    0x401145 &lt;phase_6+81&gt;
  0x0000000000401140 &lt;+76&gt;:    callq  0x40143a &lt;explode_bomb&gt;
  0x0000000000401145 &lt;+81&gt;:    add    $0x1,%ebx;ebx每次会加一,然后把值给到rax,故每次的eax是一个一个的从栈中取出元素
  0x0000000000401148 &lt;+84&gt;:    cmp    $0x5,%ebx;会循环六次;这是内层循环
  0x000000000040114b &lt;+87&gt;:    jle    0x401135 &lt;phase_6+65&gt;
  0x000000000040114d &lt;+89&gt;:    add    $0x4,%r13;r13类似于一个栈的指针,每次会往下指一个元素然后重头遍历一遍
  0x0000000000401151 &lt;+93&gt;:    jmp    0x401114 &lt;phase_6+32&gt;;这是外层循环
 .L2
 ;下一个模块:将每一个元素都变成7-int
 0x0000000000401153 &lt;+95&gt;:    lea    0x18(%rsp),%rsi;0,4,8,12,16,20,24
  0x0000000000401158 &lt;+100&gt;:   mov    %r14,%rax
  0x000000000040115b &lt;+103&gt;:   mov    $0x7,%ecx
  0x0000000000401160 &lt;+108&gt;:   mov    %ecx,%edx
  0x0000000000401162 &lt;+110&gt;:   sub    (%rax),%edx
  0x0000000000401164 &lt;+112&gt;:   mov    %edx,(%rax)
  0x0000000000401166 &lt;+114&gt;:   add    $0x4,%rax
  0x000000000040116a &lt;+118&gt;:   cmp    %rsi,%rax;一共会循环六次
  0x000000000040116d &lt;+121&gt;:   jne    0x401160 &lt;phase_6+108&gt;
  
  0x000000000040116f &lt;+123&gt;:   mov    $0x0,%esi
  0x0000000000401174 &lt;+128&gt;:   jmp    0x401197 &lt;phase_6+163&gt;
  ;这一段实现了把给定链表的数值倒序,根据权重把节点做一个移动
  0x0000000000401176 &lt;+130&gt;:   mov    0x8(%rdx),%rdx
  0x000000000040117a &lt;+134&gt;:   add    $0x1,%eax
  0x000000000040117d &lt;+137&gt;:   cmp    %ecx,%eax
  0x000000000040117f &lt;+139&gt;:   jne    0x401176 &lt;phase_6+130&gt;
  0x0000000000401181 &lt;+141&gt;:   jmp    0x401188 &lt;phase_6+148&gt;
  0x0000000000401183 &lt;+143&gt;:   mov    $0x6032d0,%edx;这个0x6032d0一看就很奇怪,咋突然冒出来,肯定是条件,然后发现她是链表头指针直接x&#x2F;24 0x6032d0就列出所有链表了
  0x0000000000401188 &lt;+148&gt;:   mov    %rdx,0x20(%rsp,%rsi,2)搬运节点到另一个位置
  0x000000000040118d &lt;+153&gt;:   add    $0x4,%rsi
  0x0000000000401191 &lt;+157&gt;:   cmp    $0x18,%rsi
  0x0000000000401195 &lt;+161&gt;:   je     0x4011ab &lt;phase_6+183&gt;
  0x0000000000401197 &lt;+163&gt;:   mov    (%rsp,%rsi,1),%ecx;
  0x000000000040119a &lt;+166&gt;:   cmp    $0x1,%ecx
  0x000000000040119d &lt;+169&gt;:   jle    0x401183 &lt;phase_6+143&gt;
  0x000000000040119f &lt;+171&gt;:   mov    $0x1,%eax
  0x00000000004011a4 &lt;+176&gt;:   mov    $0x6032d0,%edx
  0x00000000004011a9 &lt;+181&gt;:   jmp    0x401176 &lt;phase_6+130&gt;
  ;对节点保存顺序的要求
  0x00000000004011ab &lt;+183&gt;:   mov    0x20(%rsp),%rbx
  0x00000000004011b0 &lt;+188&gt;:   lea    0x28(%rsp),%rax
  0x00000000004011b5 &lt;+193&gt;:   lea    0x50(%rsp),%rsi
  0x00000000004011ba &lt;+198&gt;:   mov    %rbx,%rcx
  0x00000000004011bd &lt;+201&gt;:   mov    (%rax),%rdx
  0x00000000004011c0 &lt;+204&gt;:   mov    %rdx,0x8(%rcx);rcx是下面的节点,rdx是上面的节点,rcx+8就是下面的节点的next地址,就是反转链表,其实不是反转,只是把链表根据权重搬迁过去后,把next重排序
;;  他妈的卧槽反转链表,妈的,有理由推断出要进行遍历
  ;struct node&#123;
;  int val  &#x2F;&#x2F;4
 ; int steps  &#x2F;&#x2F;4
  ;node*next  &#x2F;&#x2F;8
 ; &#125;
  0x00000000004011c4 &lt;+208&gt;:   add    $0x8,%rax
  0x00000000004011c8 &lt;+212&gt;:   cmp    %rsi,%rax
  0x00000000004011cb &lt;+215&gt;:   je     0x4011d2 &lt;phase_6+222&gt;
  0x00000000004011cd &lt;+217&gt;:   mov    %rdx,%rcx
  0x00000000004011d0 &lt;+220&gt;:   jmp    0x4011bd &lt;phase_6+201&gt;
  ;实现了一个链表结构
  0x00000000004011d2 &lt;+222&gt;:   movq   $0x0,0x8(%rdx)
  0x00000000004011da &lt;+230&gt;:   mov    $0x5,%ebp
  0x00000000004011df &lt;+235&gt;:   mov    0x8(%rbx),%rax;rbx+8的值给到rax
  0x00000000004011e3 &lt;+239&gt;:   mov    (%rax),%eax
  0x00000000004011e5 &lt;+241&gt;:   cmp    %eax,(%rbx);所以是上面的数要小一点
  0x00000000004011e7 &lt;+243&gt;:   jge    0x4011ee &lt;phase_6+250&gt;;要大于等于,不然爆炸
  0x00000000004011e9 &lt;+245&gt;:   callq  0x40143a &lt;explode_bomb&gt;
  0x00000000004011ee &lt;+250&gt;:   mov    0x8(%rbx),%rbx;再往上找下一个数字
  0x00000000004011f2 &lt;+254&gt;:   sub    $0x1,%ebp
  0x00000000004011f5 &lt;+257&gt;:   jne    0x4011df &lt;phase_6+235&gt;
  0x00000000004011f7 &lt;+259&gt;:   add    $0x50,%rsp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>找出了题目给的的数组(结构体的值)</p>
<pre class="line-numbers language-none"><code class="language-none">(gdb) p 0x0000014c
$7 &#x3D; 332   2
(gdb) p  0x000000a8
$8 &#x3D; 168   1
(gdb) p  0x0000039c
$9 &#x3D; 924   6
(gdb) p 0x000002b3
$10 &#x3D; 691      5
(gdb) p 0x000001dd
$11 &#x3D; 477   4
(gdb) p  0x000001bb
$12 &#x3D; 443   3
(gdb)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>小于等于:降序</p>
<p>得到数据: 3 4 5 6 1 2</p>
<p>然后再把它恢复到7-int之前则是 4 3 2 1 6 5</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhzvite/picgoroom@img/img/202402071305646.jpg"></p>
<p>注意这个链表,发现他有三个值,一个是val,一个是order,一个是指向下一个的指针,例如node1.next&#x3D;&#x3D;&gt;node2</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">node</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> val<span class="token punctuation">;</span>
    <span class="token keyword">int</span> order<span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>next<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>所以捋顺一遍思路</p>
<ol>
<li>通过双层循环,判断6个数是[1,6]中的,并且各不相同</li>
<li>对六个数字取7的补,得到a1,b1,c1,d1,e1,f1</li>
<li>再根据取补后的数字,搬迁链表,把他按一个新的顺序排列</li>
<li>之后程序会对新的链表旅顺,让他能够遍历</li>
<li>判断下面的数都大于上面的数</li>
</ol>
<p>第3点是第五点的关键,我们知道链表一开始的排列,要把它安排成从上往下增大的形式,所以我们第一个要把924对应的node3丢过去,有规律可知,当a1&#x3D;3时会找到node3,把他搬迁过去,以此类推知道了a1-f1的顺序分别是3 4 5 6 1 2</p>
<p>再取补就可得到原数组 4 3 2 1 6 5</p>
<h2 id="secret-phase"><a href="#secret-phase" class="headerlink" title="secret_phase"></a>secret_phase</h2><p>在网上看了看发现了,这是phase_defused的反汇编函数,然后看他有一个secret_phase的调用</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">00000000004015c4 &lt;phase_defused&gt;:
  4015c4:	48 83 ec 78          	sub    $0x78,%rsp
  4015c8:	64 48 8b 04 25 28 00 	mov    %fs:0x28,%rax
  4015cf:	00 00 
  4015d1:	48 89 44 24 68       	mov    %rax,0x68(%rsp)
  4015d6:	31 c0                	xor    %eax,%eax
  4015d8:	83 3d 81 21 20 00 06 	cmpl   $0x6,0x202181(%rip)        # 603760 &lt;num_input_strings&gt;
  4015df:	75 5e                	jne    40163f &lt;phase_defused+0x7b&gt;
  4015e1:	4c 8d 44 24 10       	lea    0x10(%rsp),%r8
  4015e6:	48 8d 4c 24 0c       	lea    0xc(%rsp),%rcx
  4015eb:	48 8d 54 24 08       	lea    0x8(%rsp),%rdx
  4015f0:	be 19 26 40 00       	mov    $0x402619,%esi; &quot;%d %d %s&quot;
  4015f5:	bf 70 38 60 00       	mov    $0x603870,%edi;经过尝试发现和phase_4的寄存器地址时一样的
  4015fa:	e8 f1 f5 ff ff       	callq  400bf0 &lt;__isoc99_sscanf@plt&gt;
  4015ff:	83 f8 03             	cmp    $0x3,%eax
  401602:	75 31                	jne    401635 &lt;phase_defused+0x71&gt;
  #char *0x402622&#x3D;&quot;DrEvil&quot;
  401604:	be 22 26 40 00       	mov    $0x402622,%esi
  401609:	48 8d 7c 24 10       	lea    0x10(%rsp),%rdi
  40160e:	e8 25 fd ff ff       	callq  401338 &lt;strings_not_equal&gt;
  401613:	85 c0                	test   %eax,%eax
  401615:	75 1e                	jne    401635 &lt;phase_defused+0x71&gt;
  #Curses, you&#39;ve found the secret phase!
  401617:	bf f8 24 40 00       	mov    $0x4024f8,%edi
  40161c:	e8 ef f4 ff ff       	callq  400b10 &lt;puts@plt&gt;
  #But finding it and solving it are quite different...
  401621:	bf 20 25 40 00       	mov    $0x402520,%edi
  401626:	e8 e5 f4 ff ff       	callq  400b10 &lt;puts@plt&gt;
  40162b:	b8 00 00 00 00       	mov    $0x0,%eax
  401630:	e8 0d fc ff ff       	callq  401242 &lt;secret_phase&gt;
  401635:	bf 58 25 40 00       	mov    $0x402558,%edi
  40163a:	e8 d1 f4 ff ff       	callq  400b10 &lt;puts@plt&gt;
  40163f:	48 8b 44 24 68       	mov    0x68(%rsp),%rax
  401644:	64 48 33 04 25 28 00 	xor    %fs:0x28,%rax
  40164b:	00 00 
  40164d:	74 05                	je     401654 &lt;phase_defused+0x90&gt;
  40164f:	e8 dc f4 ff ff       	callq  400b30 &lt;__stack_chk_fail@plt&gt;
  401654:	48 83 c4 78          	add    $0x78,%rsp
  401658:	c3                   	retq   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们通过defuse_phase知道了secret的调用并且猜到了其中一个s密码,现在要找剩下的两个%d,然后发现他调用的寄存器时phase_4的,所以他们用的是同一个输入,我们直接在答案7 0 后面加一个 DrEvil ,这样就成功的进入这个secret_phase了  </p>
<p>secret_phase</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">0000000000401242 &lt;secret_phase&gt;:
  401242:	53                   	push   %rbx
  401243:	e8 56 02 00 00       	callq  40149e &lt;read_line&gt;;调用函数
  401248:	ba 0a 00 00 00       	mov    $0xa,%edx
  40124d:	be 00 00 00 00       	mov    $0x0,%esi
  401252:	48 89 c7             	mov    %rax,%rdi
  401255:	e8 76 f9 ff ff       	callq  400bd0 &lt;strtol@plt&gt;
  ;
  40125a:	48 89 c3             	mov    %rax,%rbx
  40125d:	8d 40 ff             	lea    -0x1(%rax),%eax;eax--
  401260:	3d e8 03 00 00       	cmp    $0x3e8,%eax&#x2F;&#x2F;eax的值 ; [1,1001]
  401265:	76 05                	jbe    40126c &lt;secret_phase+0x2a&gt;
  401267:	e8 ce 01 00 00       	callq  40143a &lt;explode_bomb&gt;
  
  40126c:	89 de                	mov    %ebx,%esi;esi中存了
  40126e:	bf f0 30 60 00       	mov    $0x6030f0,%edi;传一个值36进去
  401273:	e8 8c ff ff ff       	callq  401204 &lt;fun7&gt;
  401278:	83 f8 02             	cmp    $0x2,%eax
  40127b:	74 05                	je     401282 &lt;secret_phase+0x40&gt;
  40127d:	e8 b8 01 00 00       	callq  40143a &lt;explode_bomb&gt;
  401282:	bf 38 24 40 00       	mov    $0x402438,%edi
  401287:	e8 84 f8 ff ff       	callq  400b10 &lt;puts@plt&gt;
  40128c:	e8 33 03 00 00       	callq  4015c4 &lt;phase_defused&gt;
  401291:	5b                   	pop    %rbx
  401292:	c3                   	retq   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里面strtol的函数原型是</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">long</span> <span class="token keyword">int</span> <span class="token function">strtol</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>endptr<span class="token punctuation">,</span><span class="token keyword">int</span> base<span class="token punctuation">)</span><span class="token comment">//分别是rdi,rsi,rdx</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这里面edx&#x3D;10,所以strtol会对一串字符串读取其中的前面一段连续数字,然后转化成十进制</p>
<p>在根据10,11行可得知eax内的值&lt;&#x3D;1000</p>
<p>分析可知,fun_7的返回值必须得是2才能通过</p>
<p>fun_7</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">0000000000401204 &lt;fun7&gt;:
;esi&#x3D;999     *(edi)&#x3D;36
  401204:	48 83 ec 08          	sub    $0x8,%rsp
  #if(ptr&#x3D;&#x3D;NULL)return -1
  401208:	48 85 ff             	test   %rdi,%rdi;所以rdi的值为0就结束了,不能为0
  40120b:	74 2b                	je     401238 &lt;fun7+0x34&gt;&#x2F;&#x2F;不能跳转,跳转就爆了
  #int val &#x3D;*ptr;
  # if(val-num&lt;&#x3D;0)goto fun7_28
  40120d:	8b 17                	mov    (%rdi),%edx
  40120f:	39 f2                	cmp    %esi,%edx
  401211:	7e 0d                	jle    401220 &lt;fun7+0x1c&gt;;递归调用
 # ptr&#x3D;*(ptr+8)
  401213:	48 8b 7f 08          	mov    0x8(%rdi),%rdi
  # int retval&#x3D;2*fun7(ptr,num)
  401217:	e8 e8 ff ff ff       	callq  401204 &lt;fun7&gt;
  40121c:	01 c0                	add    %eax,%eax
  # goto fun7_57   return retval
  40121e:	eb 1d                	jmp    40123d &lt;fun7+0x39&gt;
  ---
  fun7_28
  #retval &#x3D;0
  401220:	b8 00 00 00 00       	mov    $0x0,%eax
  #if(val&#x3D;&#x3D;num)goto fun7_57  return 0
  401225:	39 f2                	cmp    %esi,%edx
  401227:	74 14                	je     40123d &lt;fun7+0x39&gt;;相等就跳转
  # ptr&#x3D;*(ptr+0x10);&#x2F;&#x2F;ptr2
  401229:	48 8b 7f 10          	mov    0x10(%rdi),%rdi;
  # retval&#x3D;2*fun7_(ptr,num)+1
  40122d:	e8 d2 ff ff ff       	callq  401204 &lt;fun7&gt;;递归调用
  401232:	8d 44 00 01          	lea    0x1(%rax,%rax,1),%eax
  #goto fun7_57
  401236:	eb 05                	jmp    40123d &lt;fun7+0x39&gt;
  401238:	b8 ff ff ff ff       	mov    $0xffffffff,%eax
  #fun7_57
  40123d:	48 83 c4 08          	add    $0x8,%rsp
  401241:	c3                   	retq   
  ;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我直接挑一个地方让esi的值等于edi的值不就好了,应为fun7函数里面esi的值不变,涉及到esi的只有比较,所以我找个地方,把rax整成2,然后找到那个时候的edi的值就行了</p>
<p>输入命令,发现是一个链表</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">0x6030f0 &lt;n1&gt;:  0x0000000000000024      0x0000000000603110
0x603100 &lt;n1+16&gt;:       0x0000000000603130      0x0000000000000000
0x603110 &lt;n21&gt;: 0x0000000000000008      0x0000000000603190
0x603120 &lt;n21+16&gt;:      0x0000000000603150      0x0000000000000000
0x603130 &lt;n22&gt;: 0x0000000000000032      0x0000000000603170
0x603140 &lt;n22+16&gt;:      0x00000000006031b0      0x0000000000000000
0x603150 &lt;n32&gt;: 0x0000000000000016      0x0000000000603270
0x603160 &lt;n32+16&gt;:      0x0000000000603230      0x0000000000000000
0x603170 &lt;n33&gt;: 0x000000000000002d      0x00000000006031d0
0x603180 &lt;n33+16&gt;:      0x0000000000603290      0x0000000000000000
0x603190 &lt;n31&gt;: 0x0000000000000006      0x00000000006031f0
0x6031a0 &lt;n31+16&gt;:      0x0000000000603250      0x0000000000000000
0x6031b0 &lt;n34&gt;: 0x000000000000006b      0x0000000000603210
0x6031c0 &lt;n34+16&gt;:      0x00000000006032b0      0x0000000000000000
0x6031d0 &lt;n45&gt;: 0x0000000000000028      0x0000000000000000
0x6031e0 &lt;n45+16&gt;:      0x0000000000000000      0x0000000000000000
0x6031f0 &lt;n41&gt;: 0x0000000000000001      0x0000000000000000
0x603200 &lt;n41+16&gt;:      0x0000000000000000      0x0000000000000000
0x603210 &lt;n47&gt;: 0x0000000000000063      0x0000000000000000
0x603220 &lt;n47+16&gt;:      0x0000000000000000      0x0000000000000000
0x603230 &lt;n44&gt;: 0x0000000000000023      0x0000000000000000
0x603240 &lt;n44+16&gt;:      0x0000000000000000      0x0000000000000000
0x603250 &lt;n42&gt;: 0x0000000000000007      0x0000000000000000
0x603260 &lt;n42+16&gt;:      0x0000000000000000      0x0000000000000000
0x603270 &lt;n43&gt;: 0x0000000000000014      0x0000000000000000
0x603280 &lt;n43+16&gt;:      0x0000000000000000      0x0000000000000000
0x603290 &lt;n46&gt;: 0x000000000000002f      0x0000000000000000
0x6032a0 &lt;n46+16&gt;:      0x0000000000000000      0x0000000000000000
0x6032b0 &lt;n48&gt;: 0x00000000000003e9      0x0000000000000000
0x6032c0 &lt;n48+16&gt;:      0x0000000000000000      0x0000000000000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>大家通过代码的翻译,能梳理出以下几点</p>
<p>目的:这个递归是对链表的递归,每一个节点都有两个指针,所以每个节点都对应着另外两个节点,我们把这个节点根据指针的顺序画出一颗树,把指针1放左边,指针二放右边,得到如下一张图.</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhzvite/picgoroom@img/img/202402071305660.jpg"></p>
<p>注:左下是指针一的节点,右边&#x3D;下是指针2的节点</p>
<p>然后梳理一遍代码规则(val为节点的值,num为输入的数字)</p>
<ol>
<li>若val&lt;num ,走右边的节点,return 时的返回值要*2+1</li>
<li>若val&gt;num,走左边的节点,return 时的返回值要*2</li>
<li>若val&#x3D;num,return 0</li>
</ol>
<p>然后我们一步一步的令num&#x3D;every val,把return的值算出来,确定是2的情况就好了</p>
<p>答案:0x14 和 0x16</p>
<h2 id="Success"><a href="#Success" class="headerlink" title="Success"></a>Success</h2><p><img src="https://cdn.jsdelivr.net/gh/zhzvite/picgoroom@img/img/202402071308029.jpg"></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Vitus Apollo</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://vitus213.github.io/2024/01/21/lab2/">http://vitus213.github.io/2024/01/21/lab2/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Vitus Apollo</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                                    <span class="chip bg-color">学习笔记</span>
                                </a>
                            
                                <a href="/tags/CSAPP/">
                                    <span class="chip bg-color">CSAPP</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2024/02/01/VOA_1/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="Coral reef">
                        
                        <span class="card-title">Coral reef</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-02-01
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/VOA/" class="post-category">
                                    VOA
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                        <span class="chip bg-color">学习笔记</span>
                    </a>
                    
                    <a href="/tags/VOA/">
                        <span class="chip bg-color">VOA</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2024/01/18/fluent_use/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="win美化fluent terminal总结">
                        
                        <span class="card-title">win美化fluent terminal总结</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-01-18
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/EATPOOP/" class="post-category">
                                    EATPOOP
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/fluent/">
                        <span class="chip bg-color">fluent</span>
                    </a>
                    
                    <a href="/tags/shell/">
                        <span class="chip bg-color">shell</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2024-2025</span>
            
            <a href="/about" target="_blank">Vitus Apollo</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">89k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2024";
                        var startMonth = "1";
                        var startDate = "1";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Vitus213" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:zhzvitus@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2811215248" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2811215248" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
